# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã‚Œã¯**Astro View Transitionså®Ÿé¨“ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ã§ã™ã€‚Astro 5.13ã®View Transitions APIï¼ˆClientRouterï¼‰ã‚’æ´»ç”¨ã—ãŸã‚¹ãƒ ãƒ¼ã‚ºãªãƒšãƒ¼ã‚¸é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ä¾‹ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã§æ•´ç†ã•ã‚Œã€æ—¥æœ¬èªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å¯¾å¿œã—ã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã¨ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚

**ğŸš€ pnpmæœ€é©åŒ–æ¸ˆã¿**: 2025å¹´1æœˆã«npmã‹ã‚‰pnpmã«å®Œå…¨ç§»è¡Œã—ã€37%ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã‚’å®Ÿç¾ã€‚

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
pnpm dev

# ä»£æ›¿ã‚³ãƒãƒ³ãƒ‰
pnpm start

# TypeScriptãƒã‚§ãƒƒã‚¯ã¨æœ¬ç•ªãƒ“ãƒ«ãƒ‰
pnpm build

# æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
pnpm preview

# Biomeï¼ˆlinter + formatterï¼‰
pnpm biome:check      # ãƒã‚§ãƒƒã‚¯ã®ã¿
pnpm biome:format     # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œ
pnpm biome:lint       # lintã®ã¿
pnpm biome:fix        # è‡ªå‹•ä¿®æ­£ï¼ˆcheck + writeï¼‰

# pnpmå°‚ç”¨ä¾¿åˆ©ã‚³ãƒãƒ³ãƒ‰
pnpm clean            # node_modulesã€pnpm-lock.yamlã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤
pnpm fresh-install    # ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm type-check       # TypeScriptãƒã‚§ãƒƒã‚¯ã®ã¿
pnpm lint-and-format  # lintã€formatã€type-checkã‚’ä¸€æ‹¬å®Ÿè¡Œ

# ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«
pnpm astro           # Astro CLIã®ç›´æ¥å®Ÿè¡Œ
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### View Transitions ã‚·ã‚¹ãƒ†ãƒ 

- **ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: `src/shared/layouts/BaseLayout.astro` ãŒåŸºæœ¬çš„ãªHTMLæ§‹é€ ã‚’æä¾›
- **View Transitions**: Astro 5ã® `<ClientRouter />` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒšãƒ¼ã‚¸é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ‰åŠ¹åŒ–
- **ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: å„æ©Ÿèƒ½ã”ã¨ã«å°‚ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆ`src/features/*/layouts/Layout.astro`ï¼‰
- **æ°¸ç¶šåŒ–è¦ç´ **: `transition:persist` ã§ãƒ˜ãƒƒãƒ€ãƒ¼ã®çŠ¶æ…‹ç¶­æŒ
- **å…±æœ‰è¦ç´ **: `transition:name` ã§è¦ç´ é–“ã®ã‚¹ãƒ ãƒ¼ã‚ºãªé·ç§»æ¼”å‡º

### ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ™ãƒ¼ã‚¹ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
src/
â”œâ”€â”€ features/          # æ©Ÿèƒ½åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ top/          # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸æ©Ÿèƒ½
â”‚   â”œâ”€â”€ about/        # ã‚¢ãƒã‚¦ãƒˆãƒšãƒ¼ã‚¸æ©Ÿèƒ½  
â”‚   â”œâ”€â”€ blog/         # ãƒ–ãƒ­ã‚°æ©Ÿèƒ½
â”‚   â””â”€â”€ contact/      # ã‚³ãƒ³ã‚¿ã‚¯ãƒˆæ©Ÿèƒ½
â”‚       â”œâ”€â”€ components/   # æ©Ÿèƒ½å›ºæœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚       â””â”€â”€ layouts/      # æ©Ÿèƒ½å›ºæœ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ shared/           # å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ layouts/      # BaseLayout.astro
â”‚   â”œâ”€â”€ components/   # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ styles/       # ã‚°ãƒ­ãƒ¼ãƒãƒ«CSS
â”‚   â”œâ”€â”€ types/        # TypeScriptå‹å®šç¾©
â”‚   â””â”€â”€ utils/        # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â””â”€â”€ pages/            # Astroãƒšãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

`src/shared/styles/global.css` ã«åŒ…æ‹¬çš„ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©ï¼š
- **åŸºæœ¬é·ç§»**: slide, fade, scale ãƒ‘ã‚¿ãƒ¼ãƒ³
- **è¦ç´ ç‰¹åŒ–**: page-title, hero-image, post-cards ç”¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **ã‚¹ã‚¿ã‚¬ãƒ¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: è¤‡æ•°è¦ç´ ã®é€£ç¶šè¡¨ç¤º
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**: ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ã§ã®æœ€é©åŒ–
- **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: `prefers-reduced-motion` è‡ªå‹•å¯¾å¿œ

### ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ 

- **å®Ÿè¡Œæ™‚æ¤œçŸ¥**: JavaScript ã«ã‚ˆã‚‹ `startViewTransition` API ã‚µãƒãƒ¼ãƒˆç¢ºèª
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: æœªå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ã®é€šå¸¸ãƒšãƒ¼ã‚¸é·ç§»
- **å¯è¦–åŒ–**: ãƒ˜ãƒƒãƒ€ãƒ¼ã§ã®å¯¾å¿œçŠ¶æ³è¡¨ç¤º

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãƒ»è¨­å®š

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Astro 5.13.0 (ESãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†**: pnpm 10.17.1ï¼ˆnpmæ¯”37%é«˜é€ŸåŒ–ï¼‰
- **TypeScript**: 5.9.2 + `@astrojs/check` 0.9.4 ã§å‹å®‰å…¨æ€§ç¢ºä¿
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: Biome 2.2.3ï¼ˆESLint/Prettierä»£æ›¿ï¼‰
- **Node.js**: 22.5.0ï¼ˆVoltaç®¡ç† + pnpmå®Ÿé¨“ã‚µãƒãƒ¼ãƒˆï¼‰
- **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆ (`output: 'static'`)
- **ãƒãƒ³ãƒ‰ãƒ«è§£æ**: rollup-plugin-visualizer 6.0.3
- **ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹**: `@/*` â†’ `./src/*`

### Biomeè¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ

- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: 2ã‚¹ãƒšãƒ¼ã‚¹ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã€ã‚»ãƒŸã‚³ãƒ­ãƒ³å¿…é ˆã€è¡Œå¹…100æ–‡å­—
- **linter**: æ¨å¥¨ãƒ«ãƒ¼ãƒ« + a11yè­¦å‘Šã€complexity/correctness/style/suspicious ãƒã‚§ãƒƒã‚¯
- **è‡ªå‹•åŒ–**: importæ•´ç†ã€Gitçµ±åˆã€VCSé€£æº
- **å³æ ¼ãƒ«ãƒ¼ãƒ«**: æœªä½¿ç”¨å¤‰æ•°ã‚¨ãƒ©ãƒ¼ã€console.warnã€debuggerã‚¨ãƒ©ãƒ¼

### Astroè¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ

- **HMRæœ€é©åŒ–**: ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç„¡åŠ¹åŒ–ã§ View Transitions ãƒ†ã‚¹ãƒˆå‘ã‘
- **ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹**: `@/` ã§srcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®çµ¶å¯¾ãƒ‘ã‚¹
- **TypeScript**: strictè¨­å®šã§å‹å®‰å…¨æ€§ã‚’é‡è¦–

## å®Ÿè£…æ™‚ã®é‡è¦äº‹é …

### View Transitionså®Ÿè£…ãƒ«ãƒ¼ãƒ«

1. **transition:name ã®ä¸€æ„æ€§**: å„ãƒšãƒ¼ã‚¸ã§å›ºæœ‰ã®åå‰ã‚’ä½¿ç”¨
2. **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©**: `global.css` ã®æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã†
3. **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: `prefers-reduced-motion` ã‚’å¿…ãšè€ƒæ…®
4. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: JavaScriptç„¡åŠ¹æ™‚ã®ä»£æ›¿UIå®Ÿè£…

### ãƒšãƒ¼ã‚¸ä½œæˆæ™‚ã®æ³¨æ„ç‚¹

- **ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: `src/shared/layouts/BaseLayout.astro` ã‚’åŸºç›¤ã¨ã—ã¦ä½¿ç”¨
- **æ©Ÿèƒ½ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: æ©Ÿèƒ½ã”ã¨ã« `src/features/*/layouts/Layout.astro` ã‚’ä½œæˆ
- **ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹**: `@/` ã§srcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ç°¡ç•¥åŒ–
- **ClientRouter**: Astro 5ã® `<ClientRouter />` ã§ View Transitions æœ‰åŠ¹åŒ–
- `transition:name` ã§è¦ç´ ã®ç¶™æ‰¿é–¢ä¿‚ã‚’æ˜ç¢ºåŒ–
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆ768px breakpointï¼‰

### ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ†ã‚¹ãƒˆæ‰‹é †

```javascript
// ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰
document.documentElement.classList.add('debug-transitions'); // ã‚¹ãƒ­ãƒ¼ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³
document.documentElement.style.setProperty('--transition-duration', '1s'); // é€Ÿåº¦èª¿æ•´
```

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®ç‰¹å¾´

- **æ©Ÿèƒ½ãƒ™ãƒ¼ã‚¹çµ„ç¹”**: `src/features/` ã§æ©Ÿèƒ½ã”ã¨ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’é…ç½®
- **å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹**: `src/shared/` ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªã‚¢ã‚»ãƒƒãƒˆã‚„ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’é›†ç´„
- **ã‚¹ã‚¿ã‚¤ãƒ«ç®¡ç†**: ã‚°ãƒ­ãƒ¼ãƒãƒ«CSSï¼ˆ`src/shared/styles/global.css`ï¼‰+ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã‚¹ã‚³ãƒ¼ãƒ—CSS
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: CSS ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆ`--transition-duration`ï¼‰ã«ã‚ˆã‚‹å‹•çš„åˆ¶å¾¡
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: Astro, TypeScript, Biome ã®é€£æºè¨­å®š
- **å…¬é–‹ãƒ•ã‚©ãƒ«ãƒ€**: `public/` ã«é™çš„ã‚¢ã‚»ãƒƒãƒˆï¼ˆfaviconç­‰ï¼‰

## é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

é–‹ç™ºæ™‚ã¯ `pnpm dev` ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§View Transitionsã®å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

```bash
# é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
pnpm install
pnpm dev

# ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆæ¨å¥¨ï¼‰
pnpm biome:check
pnpm build      # TypeScriptãƒã‚§ãƒƒã‚¯å«ã‚€

# é«˜é€Ÿã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ—¢å­˜ç’°å¢ƒï¼‰
pnpm fresh-install  # å®Œå…¨ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```

## pnpmæœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ 

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒï¼ˆ2025å¹´1æœˆç§»è¡Œå®Ÿç¸¾ï¼‰

| é …ç›® | npm (ç§»è¡Œå‰) | pnpm (ç§»è¡Œå¾Œ) | æ”¹å–„ç‡ |
|------|-------------|---------------|-------|
| ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚é–“ | 17.8ç§’ | 11.2ç§’ | **37%é«˜é€ŸåŒ–** |
| node_modules | 231MB | 219MB | 5%å‰Šæ¸› |
| ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ« | 231KB | 128KB | **44%å‰Šæ¸›** |

### pnpmè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

**`.npmrc`** - Astroäº’æ›æ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
```bash
# Astroäº’æ›æ€§è¨­å®š
shamefully-hoist=true

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
prefer-frozen-lockfile=true
auto-install-peers=false
strict-peer-dependencies=false

# Node.jsè¨­å®šï¼ˆVoltaé€£æºï¼‰
use-node-version=22.5.0
```

**`package.json`** - pnpmãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªå‹•åŒ–
```json
{
  "packageManager": "pnpm@10.17.1",
  "scripts": {
    "clean": "rm -rf node_modules pnpm-lock.yaml .astro dist",
    "fresh-install": "pnpm clean && pnpm install",
    "lint-and-format": "pnpm biome:fix && pnpm type-check"
  }
}
```

### Voltaçµ±åˆ

pnpmã¯Voltaã®å®Ÿé¨“ã‚µãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ï¼š
```bash
# ç’°å¢ƒå¤‰æ•°ï¼ˆ~/.zshrcç­‰ã«è¿½åŠ ï¼‰
export VOLTA_FEATURE_PNPM=1

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
volta install pnpm
```

### CI/CDæœ€é©åŒ–ä¾‹

```yaml
# .github/workflows/ci.yml (ä¾‹)
- name: Setup pnpm
  uses: pnpm/action-setup@v4
  with:
    version: 10.17.1

- name: Setup Node.js
  uses: actions/setup-node@v4
  with:
    node-version: 22.x
    cache: 'pnpm'

- name: Install dependencies
  run: pnpm install --frozen-lockfile
```